# Введение в командную строку Django

Django предоставляет мощный набор команд для управления проектом через утилиту `manage.py`.

## Основные команды Django

### 1. **Создание и структура проекта**

```bash
# Создание нового проекта
django-admin startproject myproject

# Создание приложения внутри проекта
python manage.py startapp myapp

# Просмотр всех доступных команд
python manage.py help

# Просмотр помощи по конкретной команде
python manage.py help <command_name>
```

### 2. **Работа с базой данных**

```bash
# Создание миграций на основе моделей
python manage.py makemigrations

# Создание миграций для конкретного приложения
python manage.py makemigrations myapp

# Применение миграций к базе данных
python manage.py migrate

# Применение миграций для конкретного приложения
python manage.py migrate myapp

# Просмотр SQL-кода миграции
python manage.py sqlmigrate myapp 0001

# Проверка проблем в проекте
python manage.py check
```

### 3. **Запуск сервера**

```bash
# Запуск сервера разработки на порту 8000
python manage.py runserver

# Запуск на определенном порту
python manage.py runserver 8080

# Запуск на определенном IP и порту
python manage.py runserver 0.0.0.0:8000

# Запуск с дополнительными настройками
python manage.py runserver --noreload  # без автоматической перезагрузки
```

### 4. **Административная панель**

```bash
# Создание суперпользователя
python manage.py createsuperuser

# Запуск скрипта в контексте Django
python manage.py shell

# Более продвинутая оболочка (если установлен ipython)
python manage.py shell -i ipython
```

### 5. **Статические файлы**

```bash
# Сбор статических файлов
python manage.py collectstatic

# Поиск статических файлов в приложениях
python manage.py findstatic css/style.css
```

## Практический пример workflow

### Шаг 1: Создание проекта
```bash
django-admin startproject myshop
cd myshop
```

### Шаг 2: Создание приложений
```bash
python manage.py startapp products
python manage.py startapp cart
python manage.py startapp orders
```

### Шаг 3: Настройка базы данных
```bash
# Создаем миграции после определения моделей
python manage.py makemigrations products
python manage.py makemigrations cart
python manage.py makemigrations orders

# Применяем все миграции
python manage.py migrate

# Проверяем проект на ошибки
python manage.py check
```

### Шаг 4: Создание администратора
```bash
python manage.py createsuperuser
# Вводим username, email, password
```

### Шаг 5: Запуск сервера
```bash
python manage.py runserver
```

## Полезные команды для разработки

### Работа с данными
```bash
# Экспорт данных
python manage.py dumpdata products > products.json

# Импорт данных
python manage.py loaddata products.json

# Очистка базы данных
python manage.py flush
```

### Отладка и тестирование
```bash
# Запуск тестов
python manage.py test

# Запуск тестов конкретного приложения
python manage.py test products

# Запуск тестов с покрытием
python manage.py test --coverage

# Просмотр миграций
python manage.py showmigrations
```

### Профилирование и оптимизация
```bash
# Проверка безопасности настроек
python manage.py check --deploy

# Создание кастомных команд
python manage.py my_custom_command
```

## Пример кастомной команды

Создаем файл `products/management/commands/update_prices.py`:

```python
from django.core.management.base import BaseCommand
from products.models import Product

class Command(BaseCommand):
    help = 'Обновление цен всех товаров'
    
    def add_arguments(self, parser):
        parser.add_argument('--discount', type=float, help='Процент скидки')
    
    def handle(self, *args, **options):
        discount = options.get('discount', 10)
        products = Product.objects.all()
        
        for product in products:
            product.price = product.price * (1 - discount/100)
            product.save()
        
        self.stdout.write(
            self.style.SUCCESS(f'Цены обновлены с скидкой {discount}%')
        )
```

Использование:
```bash
python manage.py update_prices --discount=15
```

## Полезные советы

1. **Автодополнение команд**:
```bash
# Для bash добавьте в ~/.bashrc
export DJANGO_AUTO_COMPLETE=1
```

2. **Просмотр переменных окружения**:
```bash
python manage.py diffsettings
```

3. **Создание резервной копии**:
```bash
python manage.py dumpdata --exclude=contenttypes --exclude=auth.Permission > backup.json
```

4. **Проверка URL**:
```bash
python manage.py show_urls
```

## Частые ошибки и решения

```bash
# Если команда не найдена
python manage.py help | grep нужная_команда

# Если миграции не применяются
python manage.py migrate --fake-initial

# Если проблемы с статическими файлами
python manage.py collectstatic --noinput
```

**Запомните**: Все команды Django выполняются из корневой директории проекта, где находится `manage.py`!
